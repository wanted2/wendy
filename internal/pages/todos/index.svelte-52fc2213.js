import{S as oe,i as ne,s as le,e as w,k as D,c as E,a as y,n as F,d as k,b as n,L as x,f as Y,H as f,W as V,X as Z,Y as se,Z as re,_ as ie,$ as de,a0 as $,T as ue,t as ce,V as _e,g as fe,a1 as he,w as me,x as pe,u as ve,a2 as be,a3 as ee,r as ge,a4 as ke,I as je}from"../../chunks/vendor-d0081ea9.js";import{b as R}from"../../chunks/paths-28a87002.js";function C(d,{pending:e,error:t,result:a}){let h;async function j(m){const c=h={};m.preventDefault();const v=new FormData(d);e&&e(v,d);try{const r=await fetch(d.action,{method:d.method,headers:{accept:"application/json"},body:v});if(c!==h)return;r.ok?a(r,d):t?t(r,null,d):console.error(await r.text())}catch(r){if(t)t(null,r,d);else throw r}}return d.addEventListener("submit",j),{destroy(){d.removeEventListener("submit",j)}}}function te(d,e,t){const a=d.slice();return a[6]=e[t],a[7]=e,a[8]=t,a}function ae(d,e){let t,a,h,j,m,c,v,r,o,p,_,b,I,M,O,s,i,l,T,B,N,L,H,U,A,W=je,q,X,z;function G(...g){return e[3](e[6],e[7],e[8],...g)}function J(){return e[4](e[6],e[7],e[8])}function K(){return e[5](e[6])}return{key:d,first:null,c(){t=w("div"),a=w("form"),h=w("input"),m=D(),c=w("button"),p=D(),_=w("form"),b=w("input"),M=D(),O=w("button"),i=D(),l=w("form"),T=w("button"),H=D(),this.h()},l(g){t=E(g,"DIV",{class:!0});var u=y(t);a=E(u,"FORM",{action:!0,method:!0});var P=y(a);h=E(P,"INPUT",{type:!0,name:!0,class:!0}),m=F(P),c=E(P,"BUTTON",{class:!0,"aria-label":!0}),y(c).forEach(k),P.forEach(k),p=F(u),_=E(u,"FORM",{class:!0,action:!0,method:!0});var S=y(_);b=E(S,"INPUT",{"aria-label":!0,type:!0,name:!0,class:!0}),M=F(S),O=E(S,"BUTTON",{class:!0,"aria-label":!0}),y(O).forEach(k),S.forEach(k),i=F(u),l=E(u,"FORM",{action:!0,method:!0});var Q=y(l);T=E(Q,"BUTTON",{class:!0,"aria-label":!0}),y(T).forEach(k),Q.forEach(k),H=F(u),u.forEach(k),this.h()},h(){n(h,"type","hidden"),n(h,"name","done"),h.value=j=e[6].done?"":"true",n(h,"class","svelte-dmxqmd"),n(c,"class","toggle svelte-dmxqmd"),n(c,"aria-label",v="Mark todo as "+(e[6].done?"not done":"done")),n(a,"action",r=""+(R+"/todos/"+e[6].uid+".json?_method=patch")),n(a,"method","post"),n(b,"aria-label","Edit todo"),n(b,"type","text"),n(b,"name","text"),b.value=I=e[6].text,n(b,"class","svelte-dmxqmd"),n(O,"class","save svelte-dmxqmd"),n(O,"aria-label","Save todo"),n(_,"class","text svelte-dmxqmd"),n(_,"action",s=""+(R+"/todos/"+e[6].uid+".json?_method=patch")),n(_,"method","post"),n(T,"class","delete svelte-dmxqmd"),n(T,"aria-label","Delete todo"),T.disabled=B=e[6].pending_delete,n(l,"action",N=""+(R+"/todos/"+e[6].uid+".json?_method=delete")),n(l,"method","post"),n(t,"class","todo svelte-dmxqmd"),x(t,"done",e[6].done),this.first=t},m(g,u){Y(g,t,u),f(t,a),f(a,h),f(a,m),f(a,c),f(t,p),f(t,_),f(_,b),f(_,M),f(_,O),f(t,i),f(t,l),f(l,T),f(t,H),q=!0,X||(z=[V(o=C.call(null,a,{pending:G,result:e[1]})),V(C.call(null,_,{result:e[1]})),V(L=C.call(null,l,{pending:J,result:K}))],X=!0)},p(g,u){e=g,(!q||u&1&&j!==(j=e[6].done?"":"true"))&&(h.value=j),(!q||u&1&&v!==(v="Mark todo as "+(e[6].done?"not done":"done")))&&n(c,"aria-label",v),(!q||u&1&&r!==(r=""+(R+"/todos/"+e[6].uid+".json?_method=patch")))&&n(a,"action",r),o&&Z(o.update)&&u&1&&o.update.call(null,{pending:G,result:e[1]}),(!q||u&1&&I!==(I=e[6].text)&&b.value!==I)&&(b.value=I),(!q||u&1&&s!==(s=""+(R+"/todos/"+e[6].uid+".json?_method=patch")))&&n(_,"action",s),(!q||u&1&&B!==(B=e[6].pending_delete))&&(T.disabled=B),(!q||u&1&&N!==(N=""+(R+"/todos/"+e[6].uid+".json?_method=delete")))&&n(l,"action",N),L&&Z(L.update)&&u&1&&L.update.call(null,{pending:J,result:K}),u&1&&x(t,"done",e[6].done)},r(){A=t.getBoundingClientRect()},f(){se(t),W(),re(t,A)},a(){W(),W=ie(t,A,be,{duration:200})},i(g){q||(g&&de(()=>{U||(U=$(t,ee,{start:.7},!0)),U.run(1)}),q=!0)},o(g){g&&(U||(U=$(t,ee,{start:.7},!1)),U.run(0)),q=!1},d(g){g&&k(t),g&&U&&U.end(),X=!1,ue(z)}}}function we(d){let e,t,a,h,j,m,c,v,r,o=[],p=new Map,_,b,I,M=d[0];const O=s=>s[6].uid;for(let s=0;s<M.length;s+=1){let i=te(d,M,s),l=O(i);p.set(l,o[s]=ae(l,i))}return{c(){e=D(),t=w("div"),a=w("h1"),h=ce("Todos"),j=D(),m=w("form"),c=w("input"),r=D();for(let s=0;s<o.length;s+=1)o[s].c();this.h()},l(s){_e('[data-svelte="svelte-181o7gf"]',document.head).forEach(k),e=F(s),t=E(s,"DIV",{class:!0});var l=y(t);a=E(l,"H1",{});var T=y(a);h=fe(T,"Todos"),T.forEach(k),j=F(l),m=E(l,"FORM",{class:!0,action:!0,method:!0});var B=y(m);c=E(B,"INPUT",{name:!0,"aria-label":!0,placeholder:!0,class:!0}),B.forEach(k),r=F(l);for(let N=0;N<o.length;N+=1)o[N].l(l);l.forEach(k),this.h()},h(){document.title="Todos",n(c,"name","text"),n(c,"aria-label","Add todo"),n(c,"placeholder","+ tap to add a todo"),n(c,"class","svelte-dmxqmd"),n(m,"class","new svelte-dmxqmd"),n(m,"action",""+(R+"/todos.json")),n(m,"method","post"),n(t,"class","todos svelte-dmxqmd")},m(s,i){Y(s,e,i),Y(s,t,i),f(t,a),f(a,h),f(t,j),f(t,m),f(m,c),f(t,r);for(let l=0;l<o.length;l+=1)o[l].m(t,null);_=!0,b||(I=V(v=C.call(null,m,{result:d[2]})),b=!0)},p(s,[i]){if(v&&Z(v.update)&&i&1&&v.update.call(null,{result:s[2]}),i&3){M=s[0],ge();for(let l=0;l<o.length;l+=1)o[l].r();o=he(o,i,O,1,s,M,p,t,ke,ae,null,te);for(let l=0;l<o.length;l+=1)o[l].a();me()}},i(s){if(!_){for(let i=0;i<M.length;i+=1)pe(o[i]);_=!0}},o(s){for(let i=0;i<o.length;i+=1)ve(o[i]);_=!1},d(s){s&&k(e),s&&k(t);for(let i=0;i<o.length;i+=1)o[i].d();b=!1,I()}}}const ye=async({fetch:d})=>{let e=await d("/todos.json");if(e.ok)return{props:{todos:await e.json()}};if(e=await d(`${R}/todos.json`),e.ok)return{props:{todos:await e.json()}};const{message:t}=await e.json();return{error:new Error(t)}};function Ee(d,e,t){let{todos:a}=e;async function h(r){const o=await r.json();t(0,a=a.map(p=>p.uid===o.uid?o:p))}const j=async(r,o)=>{const p=await r.json();t(0,a=[...a,p]),o.reset()},m=(r,o,p,_)=>{t(0,o[p].done=!!_.get("done"),a)},c=(r,o,p)=>t(0,o[p].pending_delete=!0,a),v=r=>{t(0,a=a.filter(o=>o.uid!==r.uid))};return d.$$set=r=>{"todos"in r&&t(0,a=r.todos)},[a,h,j,m,c,v]}class Me extends oe{constructor(e){super();ne(this,e,Ee,we,le,{todos:0})}}export{Me as default,ye as load};
